import { loadConfig, update_expected } from "../helpers";

export function sanitize(compiled) {
	return compiled.js.code.replace(/generated by Svelte v\d+\.\d+\.\d+(-\w+\.\d+)?/, 'generated by Svelte vX.Y.Z');
}

// this file will replace all the expected.js files with their _actual
// equivalents. Only use it when you're sure that you haven't
// broken anything!

update_expected(
	(compile, check, get_relative) =>
		check(
			"expected.js",
			sanitize(compile(loadConfig(get_relative("_config.js")).options))
		),
	__dirname
);
